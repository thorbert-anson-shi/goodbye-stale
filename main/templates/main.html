<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Goodbye::Stale</title>
  </head>
  <body
    class="flex flex-col h-screen w-screen justify-center items-center space-y-10"
  >
    <main
      id="items-container"
      class="flex flex-row border-2 border-black p-12 text-xl w-1/2 h-2/3 space-x-5 overflow-scroll items-center bg-white justify-center duration-500 hover:-translate-x-2 hover:-translate-y-2 hover:drop-shadow-[1rem_1rem_rgba(0,0,0,1)]"
    >
      {% for item in recipes %}
      <div
        class="w-1/2 h-full border-2 border-black p-5 overflow-scroll min-h-1/2 shrink-0"
      >
        <div
          class="rounded-t-xl bg-white p-5 flex flex-row mb-3 justify-between"
        >
          <h1 class="font-bold">{{item.name}}</h1>
          <h2 class="text-right">Rp {{item.price}}</h2>
        </div>
        <div class="px-5">
          <div>
            <h2 class="font-bold">Description</h2>
            <h2>{{item.description}}</h2>
          </div>
          <div>
            <h1 class="font-bold">Ingredients</h1>
            <ul class="list-disc pl-5">
              {% for ingredient, quantity in item.ingredients.items %}
              <li>{{ingredient}}: {{quantity}}</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="text-right align-right w-2/3 space-y-5">
        <h1 class="text-5xl font-bold">Goodbye::Stale</h1>
        <h1 class="text-3xl font-bold">
          We're cooking up something not stale! Please bear with us for a bit!
        </h1>
      </div>
      {% endfor %}
    </main>
    <dialog id="modal">
      <div
        class="flex flex-col border-2 border-black p-8 bg-white text-xl fixed w-1/2 h-1/2 bottom-1/2 left-1/2 -translate-x-1/2 translate-y-1/2"
      >
        <h1 class="font-bold text-2xl">Suggest a recipe</h1>
        <form
          action="{% url 'add_suggestion' %}"
          method="post"
          class="flex flex-col justify-between space-y-5 h-full"
        >
          {% csrf_token %}
          <input
            type="text"
            name="name"
            placeholder="Product name"
            class="p-2 border-2 border-black focus:outline-none"
          />
          <textarea
            name="description"
            placeholder="Description"
            value=""
            class="p-2 h-full resize-none overflow-scroll border-2 border-black focus:outline-none"
          >
          </textarea>
          <div
            id="btn-group"
            class="flex flex-row justify-between space-x-3 *:flex-grow *:p-3 *:border-2 *:border-black"
          >
            <button
              id="close-modal"
              type="submit"
              class="bg-white hover:bg-green-500"
            >
              Submit
            </button>
            <button
              id="cancel-submission"
              type="button"
              onclick="document.getElementById('modal').close()"
              class="bg-white hover:bg-red-500"
            >
              Cancel
            </button>
          </div>
        </form>
      </div>
    </dialog>
    <div id="contact" class="flex flex-row items-center space-x-5">
      <button
        class="p-5 font-bold bg-white text-2xl duration-500 hover:-translate-x-2 hover:drop-shadow-[0.5rem_0.5rem_rgba(0,0,0,1)] border-2 border-black"
        id="open-modal"
      >
        Give us suggestions!
      </button>
      <p class="text-xl">or contact</p>
      <button
        class="p-5 bg-white text-xl leading-snug duration-500 hover:-translate-x-2 hover:drop-shadow-[0.5rem_0.5rem_rgba(0,0,0,1)] border-2 border-black hover:cursor-default"
      >
        <p class="font-bold">Thorbert Anson Shi (PBP E)</p>
        <a
          href="mailto:tobyas2005139@gmail.com"
          class="underline hover:cursor-pointer"
          >tobyas2005139@gmail.com</a
        >
      </button>
    </div>
    <script>
      document.getElementById("open-modal").addEventListener("click", () => {
        document.getElementById("modal").showModal();
      });

      const form = document.querySelector("form");
      form.addEventListener("submit", (event) => {
        event.preventDefault();
        fetch(form.action, {
          method: "POST",
          body: new FormData(form),
        })
          .then((data) => {
            document.querySelector("dialog").close();
            alert("Your suggestion has been received!");
          })
          .catch((error) => {
            alert(error);
            console.log(error);
          });
      });
    </script>
  </body>
</html>
